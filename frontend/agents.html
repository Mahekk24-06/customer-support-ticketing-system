<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Manage Support Agents</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Poppins', sans-serif;
      display: flex;
      background-color: #f5f7fa;
    }
    .container{
        display: flex;
        height: 100vh;
    }

   .sidebar {
  width: 230px;
  background: linear-gradient(135deg, #4a00e0, #8e2de2);
  color: white;
  height: 100vh;
  padding: 25px 20px;
  position: fixed;
  box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
  display: flex;
  flex-direction: column;
  align-items: flex-start;
}

.sidebar h2 {
  font-size: 30px;
  margin-bottom: 24px;
  font-weight: 600;
}

.sidebar a {
  display: flex;
  align-items: center;
  gap: 10px;
  color: white;
  text-decoration: none;
  margin: 14px 0;
  font-size: 16px;
  transition: background 0.3s, padding-left 0.3s;
  padding: 8px 10px;
  border-radius: 6px;
  width: 100%;
}

.sidebar a:hover,
.sidebar a.active {
  background-color: rgba(255, 255, 255, 0.2);
  padding-left: 16px;
}

    .main {
      margin-left: 240px;
      padding: 30px;
      width: 100%;
    }

    .main h1 {
      color: #4e54c8;
      margin-bottom: 20px;
    }

    form {
      background: white;
      padding: 30px;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      max-width: 600px;
      margin-bottom: 40px;
    }

    form h3 {
      margin-bottom: 10px;
      color: #333;
    }

    input {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border: 1px solid #ccc;
      border-radius: 6px;
    }

    button {
      background-color: #4e54c8;
      color: white;
      border: none;
      padding: 10px 16px;
      border-radius: 6px;
      cursor: pointer;
      font-weight: bold;
    }

    button:hover {
      background-color: #3c42b5;
    }

    #successMsg {
      display: none;
      color: green;
      margin-top: 10px;
      font-weight: 500;
    }

    .agent-list {
      display: flex;
      flex-wrap: wrap;
      gap: 30px;
    }

    .agent-card {
      background-color: white;
      padding: 20px;
      width: 320px;
      border-radius: 10px;
      box-shadow: 0 4px 10px rgba(0,0,0,0.1);
      text-align: center;
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .agent-card:hover {
      transform: translateY(-5px);
      box-shadow: 0 6px 16px rgba(0,0,0,0.15);
    }

    .agent-card img {
      width: 80px;
      height: 80px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 10px;
    }

    .agent-card h4 {
      margin: 8px 0 4px;
      color: #333;
    }

    .agent-card p {
      font-size: 0.9em;
      color: #666;
    }

    @media screen and (max-width: 600px) {
      .agent-list {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <h2>Admin Panel</h2>
    <a href="overview.html">overview</a>
    <a href="agents.html" class="active">Agents</a>
    <a href="admin profile.html">Profile</a>
    <a href="logout.html">Logout</a>
  </div>

  <div class="main">
    <h1>Support Agents</h1>

    <form id="agentForm">
      <h3>Add New Agent</h3>
      <input type="text" id="agentName" placeholder="Agent Name" required />
      <input type="email" id="agentEmail" placeholder="Agent Email" required />
      <input type="url" id="agentPhoto" placeholder="Photo URL (optional)" />
      <button type="submit">Add Agent</button>
    </form>

    <div id="successMsg">Agent added successfully!</div>

    <h3>Existing Agents</h3>
<br>
    <div id="agentList" class="agent-list">
      <!-- Agent cards will appear here -->
    </div>
  </div>

  <script>

  const agentForm = document.getElementById("agentForm");
  const agentList = document.getElementById("agentList");
  const successMsg = document.getElementById("successMsg");

  // Fetch agents from backend
  async function fetchAgents() {
    try {
      const res = await fetch("http://localhost:5000/api/agents");
      const data = await res.json();
      renderAgents(data);
    } catch (err) {
      console.error("Error loading agents:", err);
    }
  }

  // Render agents
  function renderAgents(agents) {
    agentList.innerHTML = "";
    agents.forEach(agent => {
      const card = document.createElement("div");
      card.className = "agent-card";
      card.innerHTML = `
        <img src="${agent.photo || 'https://via.placeholder.com/80'}" alt="${agent.name}" />
        <h4>${agent.name}</h4>
        <p>${agent.email}</p>
      `;
      agentList.appendChild(card);
    });
  }

  // Add new agent
  agentForm.addEventListener("submit", async function (e) {
    e.preventDefault();
    const name = document.getElementById("agentName").value;
    const email = document.getElementById("agentEmail").value;
    const photo = document.getElementById("agentPhoto").value;

    try {
      const res = await fetch("http://localhost:5000/api/agents", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ name, email, photo }),
      });

      if (!res.ok) throw new Error("Failed to add agent");

      await fetchAgents(); // Refresh the agent list
      agentForm.reset();
      successMsg.style.display = "block";
      setTimeout(() => successMsg.style.display = "none", 3000);
    } catch (err) {
      alert("Error: " + err.message);
    }
  });

  fetchAgents(); // Initial call
</script>


</body>
</html>
